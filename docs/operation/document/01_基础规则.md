# 基础规则

## 概述

基础规则提供的是 ansible 操作的规则，对应的 ansible 脚本基线[打开](https://gitee.com/alinesno-cloud/alinesno-cloud-operation-incubator)，
这里建议与`jenkinsfile`，实现自动化和流程化，环境规划并不代表所有的都需要安装，按需求处理即可。

比如研发中台的环境，安装 mysql/redis/docker 即可

## 规则

- 软件始终从软件库中获取
- 软件只针对`CentOS`系统，其它系统暂不考虑
- 软件放置目录`/opt/alinesno-soft`，按软件名称放置，如 tomcat ,路径为: `/opt/alinesno-soft/tomcat`
- 集成`jenkins`，初始化工程前缀为`ansible`

## 软件管理规范

- 统一软件管理及上传,为平台内部统一软件，开发过程只允许从统一库中获取
- 软件新版本需及更新至软件库
- 软件名称规则按:`软件名称`+`版本号`+`压缩格式`
  ```
  正例: apache-tomcat-8.5.8.tar.gz
  ```
- 如无版本号,则按日期(`年月日时分`)加后缀
  ```
  正例: apache-tomcat-201811130747.tar.gz
  ```
- 软件上传之前需要做验证，确定软件可用
- 软件如需配置，需将配置文件放置于软件管理文件夹中
  ```
  正例: apache-maven-3.1.1.tar.gz  // 软件
        person-settings.xml        //个人配置文件
  ```

## Linux 安装规范

> 为了避免 Linux 上文件的乱置乱放及目录，定以下目录的规范,操作统一使用 alinesno 用户

### 目录规范

| 序号 | 说明                     | 说明 | 是否集成 | 备注 |
| ---- | ------------------------ | ---- | -------- | ---- |
| 1    | /home/alinesno/soft      |      |          |      |
| 2    | /opt/jdk8                |      |          | 全局 |
| 3    | /opt/alinesno/nginx      |      |          |      |
| 3    | /opt/alinesno/redis5     |      |          |      |
| 4    | /opt/alinesno/keepalived |      |          | 略   |

<!--
## 软件地址
| 序号 | 库类型   | 软件地址                                        | 账号密码  | 备注                          |
|------|----------|-------------------------------------------------|-----------|-------------------------------|
| 1    | 百度网盘 | https://pan.baidu.com/s/1rM8EufXR8DCqRrnsBm0LfQ | f7x5|                               |
-->

## 部署环境

- 基础环境完善及配置，为整个开发平台做基础，以环境搭建为主,为本地开发环境，
- 目前的服务器应该是不够的,也并不是代表所有的软件需要完善才可以进入下一步开发，比如 elk，前期搭建并一定是需要的，
- 比如说集群，也并不一定是一开始就是集群,
- 平台搭建一个人的话是比较长期，所以，以先投入组件构建为主，在完成第一步之后，再进一步完善，
- 即使在公司，也是如此建议，一步到位，也是比较难的，如果可以就更好。

### 开发环境

- MacPro_x64_16g_256g(SSD)

### 服务器资源

> 阿里云服务器 IP 为公网

| 序号 | 作用               | 服务器资源(系统/内存/硬盘) | IP 规划    | 备注 |
| :--: | ------------------ | -------------------------- | ---------- | ---- |
|  1   | 开发服务器\_master | CentOS7.x_x64_16G_40G      | 阿里云分配 |      |
|  2   | 基础 DevOps 平台   | CentOS7.x_x64_4G_40G       | 阿里云分配 |      |
|  3   | 注册中心           | CentOS7.x_x64_4G_40G       | 阿里云分配 | .    |

<!-- | 2    | 开发服务器_slave  | CentOS7.4_x64_2G_16G       | 192.168.1.111 | VBox虚拟机 | -->
<!-- | 3    | 开发服务器_slave  | CentOS7.4_x64_2G_16G       | 192.168.1.112 | VBox虚拟机 | -->
<!-- | 4    | 监控运维平台      | CentOS7.4_x64_4G_16G       | 192.168.1.119 | VBox虚拟机 | -->
<!-- | 7    | 基础服务服务器    | CentOS7.4_x64_1G_40G       | 172.18.11.241 | 阿里云     | -->
<!-- | 8    | 业务服务服务器    | CentOS7.4_x64_1G_40G       | 172.18.11.183 | 阿里云     | -->
<!-- | 9    | 应用服务服务器    | CentOS7.4_x64_1G_40G       | 172.18.11.130 | 阿里云     | -->

### 资源规划

> 此处的完善进度表示文档完成进度,即可根据文档查询搭建的

| 序号 | 说明               | 工具          | 文档完善进度 | 备注             |
| :--: | ------------------ | ------------- | ------------ | ---------------- |
|  1   | 基础环境           | JDK           | 已完善       |                  |
|  2   | 反向代理           | Nginx/Kong    | 已完善       |                  |
|  3   | 高可用             | KeepAlived    |              |                  |
|  4   | 自动部署工具       | Jenkins       | 完善中       |                  |
|  5   | 私服库             | Nexus         | 已完善       |                  |
|  6   | 链接跟踪           | zipkin        |              |                  |
|  7   | 代码检测           | Sonar         |              |                  |
|  8   | 缓存工具           | Redis         | 已完善       |                  |
|  9   | 消息列表           | Kafka         | 已完善       |                  |
|  10  | 分布式注册中心     | zeekeeper     | 完善中       |                  |
|  11  | 分布式注册中心     | DubboAdmin    |              |                  |
|  12  | 分布式配置中心     | Apollo        |              | 换成自研配置中心 |
|  13  | 数据库             | MySQL         | 已完善       |                  |
|  14  | 开发过程管理       | 禅道          |              |                  |
|  15  | ~~Redis 监控工具~~ | Redmon        |              |                  |
|  16  | 消息管理工具       | Kafka-Manager |              |                  |
|  17  | 数据库主从         | MyCAT         |              |                  |
|  18  | 容器管理           | Kubernetes    |              |                  |
|  19  | 镜像管理           | Harbor        |              |                  |
|  20  | 自动部署           | Ansible       |              |                  |
|  21  | ~~自动部署管理~~   | Ansible Tower |              | 版权问题         |
|  22  | ~~链接跟踪~~       | pinpoint      |              | 重复             |
|  23  | 日志监控           | elk           |              |                  |
|  24  | 服务器监控         | Zabbix        |              | .                |

<!-- | 20   | 基础环境搭建      | docker-compose | 完善中       |                  | -->

<!-- ## 访问地址 -->
<!-- | 序号 | 说明           | 地址                 | 备注 | -->
<!-- |:------|----------------|----------------------|------| -->
<!-- | 1    | 开发过程管理   | http://www.baidu.com |      | -->
<!-- | 2    | 缓存工具       |                      |      | -->
<!-- | 3    | Redis监控工具  |                      |      | -->
<!-- | 4    | 消息列表       |                      |      | -->
<!-- | 5    | 消息管理工具   |                      |      | -->
<!-- | 6    | 数据库         |                      |      | -->
<!-- | 7    | 数据库主从     |                      |      | -->
<!-- | 7    | 容器管理       |                      |      | -->
<!-- | 8    | 反向代理       |                      |      | -->
<!-- | 9    | 高可用         |                      |      | -->
<!-- | 10   | 分布式注册中心 |                      |      | -->
<!-- | 11   | 自动部署工具   |                      |      | -->
<!-- | 12   | 私服库         |                      |      | -->
<!-- | 13   | 代码检测       |                      |      | -->
<!-- | 14   | 镜像管理       |                      |      | -->
<!-- | 15   | 自动部署       |                      |      | -->
<!-- | 16   | 自动部署管理   |                      |      | -->
<!-- | 17   | 链接跟踪       |                      |      | -->
<!-- | 18   | 日志监控       |                      |      | -->
<!-- | 19   | 服务器监控     |                      |      | -->

## 其它

- 略
