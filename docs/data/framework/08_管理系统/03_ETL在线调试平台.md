# ETL 在线监控平台

## 概述

ETL(extract 提取、transform 转换、load 加载)。ETL 负责将分散的、异构数据源中的数据如关系数据、
平面数据文件等抽取到临时中间层后，进行清洗、转换、集成，最后加载到数据仓库或数据集市中，
成为联机分析处理、数据挖掘提供决策支持的数据

## 架构规划

### ETL 架构图

<img :src="$withBase('/data/etl.png')" style="zoom:35%">


### 数据清洗

| 序号 | 功能       | 描述                                                               | 备注 |
| ---- | ---------- | ------------------------------------------------------------------ | ---- |
| 1    | 数据补缺   | 对空数据、缺失数据进行数据补缺操作，无法处理的做标记               |      |
| 2    | 数据替换   | 对无效数据进行数据的替换                                           |      |
| 3    | 格式规范化 | 将源数据抽取的数据格式转换成为便于进入仓库处理的目标数据格式       |      |
| 4    | 主外键约束 | 通过建立主外键约束，对非法数据进行数据替换或导出到错误文件重新处理 |      |

### 数据转换

| 序号 | 功能     | 描述                                                                                       | 备注 |
| ---- | -------- | ------------------------------------------------------------------------------------------ | ---- |
| 1    | 数据合并 | 多用表关联实现，大小表关联用 lookup，大大表相交用 join(每个字段家索引，保证关联查询的效率) |      |
| 2    | 数据拆分 | 按一定规则进行数据拆分                                                                     |      |
| 3    | 行列互换 | 排序/修改序号、去除重复记录                                                                |      |
| 4    | 数据验证 | loolup、sum、count                                                                         |      |

### 数据加载

| 序号 | 功能             | 描述                                                                                        | 备注 |
| ---- | ---------------- | ------------------------------------------------------------------------------------------- | ---- |
| 1    | 时间戳方式       | 在业务表中统一添加字段作为时间戳，当 OLAP 系统更新修改业务数据时，同时修改时间戳字段值      |      |
| 2    | 日志表方式       | 在 OLAP 系统中添加日志表，业务数据发生变化时，更新维护日志表内容                            |      |
| 3    | 全表对比方式     | 抽取所有源数据，在更新目标表之前先根据主键和字段进行数据比对，有更新的进行 update 或 insert |      |
| 4    | 全表删除插入方式 | 删除目标表数据，将源数据全部插入                                                            |      |

## 功能设计

如果动辄上百或几十个 job 需要管理，这时在使用客户端管理已经很难编排,设计在线 job 管理功能,便于管理

| 序号 | 功能                                                            | 进度 | 备注 |
| ---- | --------------------------------------------------------------- | ---- | ---- |
| 1    | 定时设置，可以按照 cron 的方式，设置定时的周期和时间            |      |      |
| 2    | 可以进行作业调度和转换调度                                      |      |      |
| 3    | 对作业和转换的执行情况进行监控                                  |      |      |
| 4    | 实时查看作业运行日志，查看 log 日志，查看 kettle 内部的运行日志 |      |      |
| 5    | 支持数据库资源库和文件资源库，可以共享进行多人开发              |      |      |
| 6    | 支持多人协作的多用户模式，权限隔离                              |      |      |
| 7    | 采用 B/S 结构，灵活部署                                         |      |      |
| 8    | 可以进行集群部署、分布式部署，提高承载能力                      |      |      |
| 9    | 可以进行任务判断和补发，提高容错能力                            |      |      |

## 其它

- 略
