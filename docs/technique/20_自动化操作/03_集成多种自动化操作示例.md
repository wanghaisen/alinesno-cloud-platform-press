# 集成自动化操作

## 工程示例

系统应用集成示例工程[打开](https://gitee.com/alinesno-cloud/alinesno-demo-gateway-open/tree/master/demo-message)

## 概述

这里主要阐述自动化配置集成的方式，比如包括自我定义，业务集成定义等方式

## 本内容你将获得

- 自动化集成的能力有哪些
- 如何对自动化集成能力扩展
- 怎么集成自动化配置
- 如何集成自己的业务自动化

## 自动化扩展架构设计

> 待补充

架构描述:

- 自定义`scriptsdk`包，进行多种能力扩展
- 脚本工程中调用sdk扩展能力，进行服务编排
- 本地验证通过，则发布到自动化操作平台

### 添加依赖包

```xml
<dependency>
		<groupId>com.alinesno.cloud</groupId>
		<artifactId>alinesno-cloud-operation-scriptsdk</artifactId>
		<version>${revision}</version>
</dependency>
```

### 脚本编辑器

请确保本地已经安装groovy编辑器，验证方式如下:
```shell
groovy -v
```

打开Idea工具，配置好groovy引擎，进行脚本编排，以为下例子:

```groovyimport org.slf4j.Logger
import org.slf4j.LoggerFactory
import groovy.sql.Sql

//--------------- groovy script -----------
static void main(String[] args){

    Test t = new Test() 
    t.hello(); 

	println("args = " + args)

	t.helloWorld() 
	t.getResultApi() 
	t.connectMySqk()

}

class Test {
    static Logger log = LoggerFactory.getLogger(Test.class)

    def helloWorld(){
        println("hello groovy")  
        log.info("hello world!") 
    }

    def getFileText(file){
        return (new File(file)).text
        log.info("get File Text!") 
    }

    def getResultApi(){
        def res1 = new URL('https://api.apiopen.top/api/getImages?page=0&size=5').text
        println("res1 = " + res1) 
        log.info("result = {}" , res1) 
    }

    // 连接到mysql操作
    
    def connectMySqk(){
        Class.forName("com.mysql.jdbc.Driver")
        def conn = Sql.newInstance("jdbc:mysql://localhost:3306/demo?useUnicode=true&characterEncoding=utf8&characterSetResults=utf8&useSSL=false&serverTimezone=GMT", "root", "admin", "com.mysql.cj.jdbc.Driver")
        def rows = conn.rows("select username from users LIMIT 10") 

        log.debug("conn = {}" , conn)
        log.debug("rows = {}" , rows)
    }

    def hello(){
        println("class hello , world")
        log.debug("this is a test of my groovy script!!")
    }
}

```

### 当前集成的能力如下:

主要集成的数据接口能力，主要模块如下：

- 备份工具：数据备份，ETL数据采集管理，代码备份，日志备份等
- ETL工具：轻量级的数据转换，数据抽取
- CMDB工具：轻量级的hosts主机管理，获取主机状态，服务器情况等
- 消息工具：消息的接发配置，包括redis/kafka/rocketmq等
- 通知工具：集成钉钉通知，短信通知，电话通知，邮件通知，飞书通知等
- 命令行工具：命令行执行工具，包括shell/ansible等
- 存储工具：文件的存储上传获取等，偏于对一些项目文件的配置管理

具体工具类文档，待补充

## 其它

- 无
